#pragma once

#include <string>
#include <sstream>
#include <memory>
#include "scan_results.h"

class IVulnerablity {
public:
	virtual std::string getCVE() = 0;

	virtual DETECTION_CONFIDENCE getConfidenceLevel() = 0;

	virtual void setDetectStatus(DETECTION_STATUS status) = 0;
};


class CVulnerablity : public IVulnerablity {

public:
	CVulnerablity(std::string sCVE);


public:
	inline std::string getCVE() { return sCVE; }

	inline DETECTION_CONFIDENCE getConfidenceLevel() { return detectionToConfidence(status); }

	inline void setDetectStatus(DETECTION_STATUS status) { this->status |= status; }

private:


private:
	std::string sCVE;
	DETECTION_STATUS status;
};


class CVulnerablityFactory {
public:
	static std::shared_ptr<IVulnerablity> getVulnerablity(std::string sCVE) {
		return std::make_shared<CVulnerablity>(sCVE);
	}
};