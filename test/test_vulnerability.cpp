#include "vulnerability.h"

#include "gtest/gtest.h"

#include <vector>

TEST(CVulnerablity, getsetDetectStatus)
{
	CVulnerablity vuln("CVE-test");

	ASSERT_EQ(vuln.getDetectStatus(), DETECTION_NOMATCH);
	vuln.setDetectStatus(DETECTION_ASM_MATCH | DETECTION_STRING_MATCH);
	ASSERT_EQ(vuln.getDetectStatus(), DETECTION_ASM_MATCH | DETECTION_STRING_MATCH);
}

TEST(CVulnerablity, appendDetectStatus)
{
	CVulnerablity vuln("CVE-test");
	ASSERT_EQ(vuln.getDetectStatus(), DETECTION_NOMATCH);
	vuln.appendDetectStatus(DETECTION_ASM_MATCH);
	ASSERT_EQ(vuln.getDetectStatus(), DETECTION_ASM_MATCH);
	vuln.appendDetectStatus(DETECTION_STRING_MATCH);
	ASSERT_EQ(vuln.getDetectStatus(), DETECTION_ASM_MATCH | DETECTION_STRING_MATCH);
}